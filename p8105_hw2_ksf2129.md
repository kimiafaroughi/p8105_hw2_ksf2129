p8105_hw2_ksf2129
================
Kimia Faroughi
2025-09-30

## Problem 1

Import and clean the `pols-month.csv` dataset.

``` r
pols_month_df =
  read_csv("fivethirtyeight_datasets/pols-month.csv") |> 
  separate(
    mon, into = c("year", "month", "day"), sep = "-", convert = TRUE
  ) |> #separates mon into year, month, and day based on the dash in the string name and converts to integers
  mutate(
    month = case_match(
      month,
      1 ~ "January",
      2 ~ "February",
      3 ~ "March",
      4 ~ "April",
      5 ~ "May",
      6 ~ "June",
      7 ~ "July",
      8 ~ "August",
      9 ~ "September",
      10 ~ "October",
      11 ~ "November",
      12 ~ "December"), #replaces month number with month name
    president = case_match(
      prez_gop,
      1 ~ "gop",
      0 ~ "dem") #creates president var
  ) |> 
  select(-prez_gop, -prez_dem, -day) |> #drop prez_gop, prez_dem, and day from dataset
  relocate(year, month) #make year and month the leading columns
```

    ## Rows: 822 Columns: 9
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl  (8): prez_gop, gov_gop, sen_gop, rep_gop, prez_dem, gov_dem, sen_dem, r...
    ## date (1): mon
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

Clean `snp.csv` in the same way.

``` r
snp_df =
  read_csv("fivethirtyeight_datasets/snp.csv") |> 
  separate(
    date, into = c("month", "day", "year"), sep = "/", convert = TRUE
  ) |> #separates date into month, day, year based on the slash in the string name and converts to integers
  mutate(
    month = case_match(
      month,
      1 ~ "January",
      2 ~ "February",
      3 ~ "March",
      4 ~ "April",
      5 ~ "May",
      6 ~ "June",
      7 ~ "July",
      8 ~ "August",
      9 ~ "September",
      10 ~ "October",
      11 ~ "November",
      12 ~ "December"), #replaces month number with month name
    #add 19 to years 0-15, and 20 to all others (for complete year to be consistent with other datasets)
    year = ifelse(year <= 15, 2000 + year, 1900 + year) 
  ) |> 
  select(-day) |> #drop day from dataset
  relocate(year, month) #make year and month the leading columns
```

    ## Rows: 787 Columns: 2
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (1): date
    ## dbl (1): close
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

Tidy the `unemployment.csv` dataset.

``` r
unemployment_df =
  read_csv("fivethirtyeight_datasets/unemployment.csv") |> 
  pivot_longer(
    cols = Jan:Dec,
    names_to = "month",
    values_to = "unemployment_pct"
  ) |> #puts unemployment % for each month var into one column indicating month and one indicating unemployment %
  mutate(
    month = case_match(
      month,
      "Jan" ~ "January",
      "Feb" ~ "February",
      "Mar" ~ "March",
      "Apr" ~ "April",
      "May" ~ "May",
      "Jun" ~ "June",
      "Jul" ~ "July",
      "Aug" ~ "August",
      "Sep" ~ "September",
      "Oct" ~ "October",
      "Nov" ~ "November",
      "Dec" ~ "December"
    )
  ) |> 
  rename(year = Year) #make column name for year lowercase
```

    ## Rows: 68 Columns: 13
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl (13): Year, Jan, Feb, Mar, Apr, May, Jun, Jul, Aug, Sep, Oct, Nov, Dec
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

Join the datasets.

``` r
#merge snp into pols dataset
pols_snp = 
  left_join(pols_month_df, snp_df, by = c("year", "month"))

#merge unemployment into joint dataset
final_df = 
  left_join(pols_snp, unemployment_df, by = c("year", "month"))
```

The `pols_month.csv` dataset contains 822 observations of 9 variables on
the number of national politicians who are democratic or republican at
any given time (represented by a yyyy-mm-dd format) in various
categories: president, governors, senators, and representatives. The
`snp.csv` dataset contains 787 observations of 2 variables on the
closing values of the S&P stock index, where each observation is on a
different date (represented by a m/d/yy format). The `unemployment.csv`
dataset contains 68 observations of 13 variables on the percentage of
unemployment with each month as a separate variable, where each
observation represents a unique year.

In the resulting dataset, there are 822 rows (observations) and 11
columns (variables). The variables in this dataset include: year, month,
gov_gop, sen_gop, rep_gop, gov_dem, sen_dem, rep_dem, president, close,
unemployment_pct. The range of years included in this dataset is from
1947 to 2015.

## Problem 2

Import and clean the Mr. Trash Wheel sheet in the
`202509 Trash Wheel Collection Data.xlsx` dataset.

``` r
mr_trash_df = 
  read_excel("202509 Trash Wheel Collection Data.xlsx", 
             sheet = "Mr. Trash Wheel",
             range = "A2:N709") |> #import data from excel, omit non-data
  janitor::clean_names() |> #clean var names
  mutate(
    sports_balls = round(sports_balls), #round sports balls to nearest integer
    sports_balls = as.integer(sports_balls), #convert sports balls to integer
    year = as.double(year), #convert year to double
    wheel = "mr_trash", #create var for which wheel this is
  )
```

Import and clean the Professor Trash Wheel sheet in the
`202509 Trash Wheel Collection Data.xlsx` dataset.

``` r
prof_trash_df = 
  read_excel("202509 Trash Wheel Collection Data.xlsx", 
             sheet = "Professor Trash Wheel",
             range = "A2:M134") |> #import data from excel, omit non-data
  janitor::clean_names() |> #clean var names
  mutate(wheel = "professor_trash") #create var for which wheel this is
```

Import and clean the Gwynns Falls Trash Wheel sheet in the
`202509 Trash Wheel Collection Data.xlsx` dataset.

``` r
gwynns_falls_df = 
  read_excel("202509 Trash Wheel Collection Data.xlsx", 
             sheet = "Gwynns Falls Trash Wheel",
             range = "A2:L351") |> #import data from excel, omit non-data
  janitor::clean_names() |> #clean var names
  mutate(wheel = "gwynns_falls") #create var for which wheel this is
```

Combine datasets into single tidy dataset.

``` r
mr_trash_tidy = 
  bind_rows(mr_trash_df, prof_trash_df, gwynns_falls_df)
```

In combining the Mr. Trash Wheel, Professor Trash Wheel, and Gwynns
Falls Trash Wheel sheets in the
`202509 Trash Wheel Collection Data.xlsx` dataset, the following
variables are included: dumpster, month, year, date, weight_tons,
volume_cubic_yards, plastic_bottles, polystyrene, cigarette_butts,
glass_bottles, plastic_bags, wrappers, sports_balls, homes_powered,
wheel. Key variables include `wheel`, which represents whether the data
is from the Mr. Trash, Professor Trash, or Gwynns Falls wheels, and
`date`, which represents the date of the observation (each dumpster).
`sports_balls` is also important to point out as the variable that
represents the number of sports balls counted in each dumpster, but data
for `sports_balls` is only available for the Mr. Trash Wheel.
`weight_tons` represents the weight in tons of trash collected in each
dumpster, and `cigarette_butts` is the number of cigarette butts counted
in each dumpster.

There are 1188 rows (observations) and 15 columns (variables).

The total weight of trash collected by the Professor Trash Wheel based
on available data is 282.26 tons. The total number of cigarette butts
collected by the Gwynns Falls Trash Wheel in June of 2022 based on
available data is 1.812^{4}.

## Problem 3

Import and tidy the `Zip Codes.csv` and
`Zip_zori_uc_sfrcondomfr_sm_month_NYC.csv` datasets.

``` r
zip_codes_df =
  read_csv("zillow_data/Zip Codes.csv") |> 
  janitor::clean_names() |> 
  relocate(zip_code, county, neighborhood) #puts zip code, county, and neighborhood at the front
```

    ## Rows: 322 Columns: 7
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (4): County, County Code, File Date, Neighborhood
    ## dbl (3): State FIPS, County FIPS, ZipCode
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
zip_zori_df =
  read_csv("zillow_data/Zip_zori_uc_sfrcondomfr_sm_month_NYC.csv") |> 
  janitor::clean_names() |> 
  pivot_longer(
    cols = x2015_01_31:x2024_08_31,
    names_to = "date",
    values_to = "rent",
    names_prefix = "x" #deletes prefix string from each name value
  ) |> #put vars representing each date into its own var with another var corresponding to rent prices
  separate(
    date, into = c("year", "month", "day"), sep = "_", convert = TRUE
  ) |> #separate date into year, month, and day
  rename(zip_code = region_name, county = county_name) |> 
  mutate(county = str_remove(county, " County")) |> #deletes suffix string from each value
  relocate(zip_code, county, month, day, year, rent) #puts zip code, county, month, day, year, and rent at the front
```

    ## Rows: 149 Columns: 125
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr   (6): RegionType, StateName, State, City, Metro, CountyName
    ## dbl (119): RegionID, SizeRank, RegionName, 2015-01-31, 2015-02-28, 2015-03-3...
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

Merge datasets.

``` r
zillow_tidy =
  left_join(zip_zori_df, zip_codes_df, by = c("zip_code", "county")) |> 
  relocate(zip_code, neighborhood, county, month, day, year, rent) |> 
  mutate(zip_code = as.character(zip_code)) #convert zip code to character var

#use skimr to determine number of unique obs per zip code and neighborhood
skimr::skim(zillow_tidy)
```

|                                                  |             |
|:-------------------------------------------------|:------------|
| Name                                             | zillow_tidy |
| Number of rows                                   | 17284       |
| Number of columns                                | 18          |
| \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_   |             |
| Column type frequency:                           |             |
| character                                        | 10          |
| numeric                                          | 8           |
| \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_ |             |
| Group variables                                  | None        |

Data summary

**Variable type: character**

| skim_variable | n_missing | complete_rate | min | max | empty | n_unique | whitespace |
|:--------------|----------:|--------------:|----:|----:|------:|---------:|-----------:|
| zip_code      |         0 |          1.00 |   5 |   5 |     0 |      149 |          0 |
| neighborhood  |       696 |          0.96 |   7 |  29 |     0 |       42 |          0 |
| county        |         0 |          1.00 |   5 |   8 |     0 |        5 |          0 |
| region_type   |         0 |          1.00 |   3 |   3 |     0 |        1 |          0 |
| state_name    |         0 |          1.00 |   2 |   2 |     0 |        1 |          0 |
| state         |         0 |          1.00 |   2 |   2 |     0 |        1 |          0 |
| city          |         0 |          1.00 |   8 |   8 |     0 |        1 |          0 |
| metro         |         0 |          1.00 |  37 |  37 |     0 |        1 |          0 |
| county_code   |       116 |          0.99 |   3 |   3 |     0 |        5 |          0 |
| file_date     |       116 |          0.99 |   7 |   7 |     0 |        1 |          0 |

**Variable type: numeric**

| skim_variable | n_missing | complete_rate | mean | sd | p0 | p25 | p50 | p75 | p100 | hist |
|:---|---:|---:|---:|---:|---:|---:|---:|---:|---:|:---|
| month | 0 | 1.00 | 6.36 | 3.42 | 1.0 | 3.00 | 6.00 | 9.00 | 12.00 | ▇▅▅▅▇ |
| day | 0 | 1.00 | 30.44 | 0.81 | 28.0 | 30.00 | 31.00 | 31.00 | 31.00 | ▁▁▁▅▇ |
| year | 0 | 1.00 | 2019.34 | 2.80 | 2015.0 | 2017.00 | 2019.00 | 2022.00 | 2024.00 | ▇▇▇▇▇ |
| rent | 6834 | 0.60 | 2889.11 | 884.05 | 1102.4 | 2244.18 | 2701.29 | 3373.24 | 8422.62 | ▇▇▂▁▁ |
| region_id | 0 | 1.00 | 66415.47 | 38858.63 | 61615.0 | 61657.00 | 62005.00 | 62045.00 | 399546.00 | ▇▁▁▁▁ |
| size_rank | 0 | 1.00 | 2533.31 | 4014.37 | 4.0 | 142.00 | 1025.00 | 3485.00 | 30490.00 | ▇▁▁▁▁ |
| state_fips | 116 | 0.99 | 36.00 | 0.00 | 36.0 | 36.00 | 36.00 | 36.00 | 36.00 | ▁▁▇▁▁ |
| county_fips | 116 | 0.99 | 36055.57 | 24.81 | 36005.0 | 36047.00 | 36061.00 | 36081.00 | 36085.00 | ▃▁▆▇▇ |

After tidying and combining `Zip Codes.csv` and
`Zip_zori_uc_sfrcondomfr_sm_month_NYC.csv`, the resulting dataset has
17284 rows (observations). There are 149 unique zip codes and 42 unique
neighborhoods included in this dataset.

**Determine which zip codes appear in the ZIP code dataset but not in
the Zillow Rental Price dataset.**

``` r
zip_codes_df = arrange(zip_codes_df, zip_code, county, neighborhood)

zip_zori_df = arrange(zip_zori_df, zip_code, county)
```

The zip codes that appear in the ZIP code dataset but not in the Zillow
Rental Price dataset appear to be ones whose geographical range is very
small and in areas that likely do not include residential buildings. For
example, 10047, 10048, and 10055 are all excluded from the Zillow Rental
Price dataset. In doing some research, I found that 10048 used to be the
zip code assigned only to the World Trade Centers. The other two
similarly only represent geographic areas covering an office building or
plaza, in which no one is living. Therefore, it makes sense that these
are excluded from the Zillow Rental Price dataset because there are no
rental units available in those zip codes.

**Compare how rental prices changed between January 2020 and 2021.**

``` r
compare_zillow_tidy =
  select(zillow_tidy, zip_code, month, year, rent) |> 
  filter(month == 1, year %in% c(2020, 2021)) |> 
  arrange(zip_code)
```

By scanning the data, the price of rent generally drops from January
2020 to January 2021 by zip code.

**Table of 10 zip codes with largest drop in price from Jan 2020 - Jan
2021.**

``` r
compare_zillow_tidy =
  select(zillow_tidy, zip_code, month, year, rent, neighborhood, county) |> 
  filter(month == 1, year %in% c(2020, 2021)) |> #filter to only include January of 2020 and 2021
  arrange(zip_code) |> #arrange by zip code
  pivot_wider(
    names_from = year,
    values_from = rent
  ) |> #put each year as its own variable with values representing the rent
  mutate(
    price_drop = `2020` - `2021`
  ) |> #calculate the price drop between Jan 2020 and Jan 2021
  slice_max(order_by = price_drop, n = 10) |> #retain only the 10 largest price drops
  select(-month) |> #get rid of month (all of them are January)
  relocate(zip_code, price_drop) #move zip code and price drop vars to the front

compare_zillow_tidy |> knitr::kable() #create table
```

| zip_code | price_drop | neighborhood                  | county   |     2020 |     2021 |
|:---------|-----------:|:------------------------------|:---------|---------:|---------:|
| 10007    |   912.5966 | Lower Manhattan               | New York | 6334.211 | 5421.614 |
| 10069    |   748.1245 | NA                            | New York | 4623.042 | 3874.918 |
| 10009    |   714.2550 | Lower East Side               | New York | 3406.442 | 2692.187 |
| 10016    |   711.7045 | Gramercy Park and Murray Hill | New York | 3731.135 | 3019.431 |
| 10001    |   710.4499 | Chelsea and Clinton           | New York | 4108.098 | 3397.648 |
| 10002    |   710.3028 | Lower East Side               | New York | 3645.416 | 2935.113 |
| 10004    |   705.9608 | Lower Manhattan               | New York | 3149.658 | 2443.697 |
| 10038    |   697.5853 | Lower Manhattan               | New York | 3573.201 | 2875.616 |
| 10012    |   686.2218 | Greenwich Village and Soho    | New York | 3628.566 | 2942.344 |
| 10010    |   684.9304 | Gramercy Park and Murray Hill | New York | 3697.284 | 3012.353 |

The table shows that the largest drop in price from January 2020 to
January 2021 occurred in the zip code 10007 (in Lower Manhattan), in
which the price of rent dropped by \$912.60. All the neighborhoods for
the 10 zip codes with the largest drop in price are in Manhattan.
