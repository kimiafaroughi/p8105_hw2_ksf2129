---
title: "p8105_hw2_ksf2129"
author: "Kimia Faroughi"
date: "2025-09-30"
output: github_document
---

```{r setup, echo = FALSE, message = FALSE}
library(tidyverse)
```

## Problem 1

Import and clean the `pols-month.csv` dataset.

```{r}
pols_month_df =
  read_csv("fivethirtyeight_datasets/pols-month.csv") |> 
  separate(
  mon, into = c("year", "month", "day"), sep = "-", convert = TRUE
  ) |> #separates mon into year, month, and day based on the dash in the string name and converts to integers
  mutate(
    month = case_match(
    month,
    1 ~ "January",
    2 ~ "February",
    3 ~ "March",
    4 ~ "April",
    5 ~ "May",
    6 ~ "June",
    7 ~ "July",
    8 ~ "August",
    9 ~ "September",
    10 ~ "October",
    11 ~ "November",
    12 ~ "December"
    )
  ) |> #replaces month number with month name
  mutate(
    president = case_match(
      prez_gop,
      1 ~ "gop",
      0 ~ "dem")
  ) |> #creates president var
  select(-prez_gop, -prez_dem, -day) |> #drop prez_gop, prez_dem, and day from dataset
  relocate(year, month) #make year and month the leading columns
```

Clean `snp.csv` in the same way.

```{r}
snp_df =
  read_csv("fivethirtyeight_datasets/snp.csv") |> 
  separate(
  date, into = c("month", "day", "year"), sep = "/", convert = TRUE
  ) |> #separates date into month, day, year based on the slash in the string name and converts to integers
  mutate(
    month = case_match(
    month,
    1 ~ "January",
    2 ~ "February",
    3 ~ "March",
    4 ~ "April",
    5 ~ "May",
    6 ~ "June",
    7 ~ "July",
    8 ~ "August",
    9 ~ "September",
    10 ~ "October",
    11 ~ "November",
    12 ~ "December"
    )
  ) |> #replaces month number with month name
  mutate(
    year = ifelse(year <= 15, 2000 + year, 1900 + year)
    ) |> #add 19 to years 0-15, and 20 to all others (for complete year to be consistent with other datasets)
  select(-day) |> #drop day from dataset
  relocate(year, month) #make year and month the leading columns
```

Tidy the `unemployment.csv` dataset.

```{r}
unemployment_df =
  read_csv("fivethirtyeight_datasets/unemployment.csv") |> 
  pivot_longer(
    cols = Jan:Dec,
    names_to = "month",
    values_to = "unemployment_pct"
  ) |> #puts unemployment % for each month var into one column indicating month and one indicating unemployment %
  mutate(
    month = case_match(
    month,
    "Jan" ~ "January",
    "Feb" ~ "February",
    "Mar" ~ "March",
    "Apr" ~ "April",
    "May" ~ "May",
    "Jun" ~ "June",
    "Jul" ~ "July",
    "Aug" ~ "August",
    "Sep" ~ "September",
    "Oct" ~ "October",
    "Nov" ~ "November",
    "Dec" ~ "December"
    )
  ) |> 
  rename(year = Year) #make column name for year lowercase
```

Join the datasets.

```{r}
#merge snp into pols dataset
pols_snp = 
  left_join(pols_month_df, snp_df, by = c("year", "month"))

#merge unemployment into joint dataset
final_df = 
  left_join(pols_snp, unemployment_df, by = c("year", "month"))
```

The `pols_month.csv` dataset contains 822 observations of 9 variables on the number of national politicians who are democratic or republican at any given time (represented by a yyyy-mm-dd format) in various categories: president, governors, senators, and representatives. The `snp.csv` dataset contains 787 observations of 2 variables on the closing values of the S&P stock index, where each observation is on a different date (represented by a m/d/yy format). The `unemployment.csv` dataset contains 68 observations of 13 variables on the percentage of unemployment with each month as a separate variable, where each observation represents a unique year. 

In the resulting dataset, there are `r nrow(final_df)` rows (observations) and `r ncol(final_df)` columns (variables). The variables in this dataset include: `r names(final_df)`. The range of years included in this dataset is from `r min(final_df$year)` to `r max(final_df$year)`. 